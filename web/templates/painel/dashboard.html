{% extends "public/base.html" %}
{% block title %}Dashboard - Insight Futures{% endblock %}

{# >>> chave usada pelo main.js para saber o que carregar #}
{% block page_key %}dashboard{% endblock %}

{% block body_wrapper %}
<main data-page="dashboard">
  <section id="dash" class="container-if section flex flex-col items-center text-center pt-6 pb-12">
    <h1 class="text-4xl md:text-5xl font-semibold pb-16
               bg-gradient-to-r from-cyan-400 via-teal-400 to-lime-400
               bg-clip-text text-transparent
               drop-shadow-[0_0_15px_rgba(0,255,200,0.8)]">
      Que tal buscar novos insights hoje?
    </h1>


    <div class="flex flex-wrap justify-center gap-8 text-xs md:text-sm">
      <!-- Upload de uma nova Estrat√©gia -->
      <a href="{{ url_for('painel_routes.upload_page') }}" class="flex flex-col items-center hover:scale-110 hover:text-lime-300 transition duration-200">
        <span class="brand-badge glow-emerald mb-3">
          <span class="brand-ring"></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-emerald-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M20 16.5A3.5 3.5 0 0 0 16.5 13h-1.3a5 5 0 1 0-9.7 2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12 12v9" stroke-linecap="round"/>
            <path d="m16 16-4-4-4 4" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span>Upload de uma nova Estrat√©gia</span>
      </a>

      <!-- Analisar suas Estrat√©gias -->
      <a href="{{ url_for('painel_routes.analise_pre') }}" class="flex flex-col items-center hover:scale-110 hover:text-lime-300 transition duration-200">
        <span class="brand-badge glow-sky mb-3">
          <span class="brand-ring"></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-sky-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M3 3v18h18" stroke-linecap="round"/>
            <rect x="7" y="10" width="3" height="7" rx="1"/>
            <rect x="12" y="6" width="3" height="11" rx="1"/>
            <rect x="17" y="12" width="3" height="5" rx="1"/>
          </svg>
        </span>
        <span>Analisar suas Estrat√©gias</span>
      </a>

      <!-- Ver Drawdown Atual -->
      <a href="{{ url_for('painel_routes.analise_drawdown') }}" class="flex flex-col items-center hover:scale-110 hover:text-lime-300 transition duration-200">
        <span class="brand-badge glow-red mb-3">
          <span class="brand-ring"></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-red-400" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M3 3v18h18" stroke-linecap="round"/>
            <path d="M19 8l-5 5-4-4-6 6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span>Ver Drawdown Atual</span>
      </a>

      <!-- Fazer um novo Backtest -->
      <a href="{{ url_for('painel_routes.parametrizacao') }}" class="flex flex-col items-center hover:scale-110 hover:text-lime-300 transition duration-200">
        <span class="brand-badge glow-indigo mb-3">
          <span class="brand-ring"></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-indigo-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M3 2v6h6" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 22v-6h-6" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 8a9 9 0 0 1 15-6" stroke-linecap="round"/>
            <path d="M21 16a9 9 0 0 1-15 6" stroke-linecap="round"/>
          </svg>
        </span>
        <span>Fazer um novo Backtest</span>
      </a>

      <!-- Buscar Insights -->
      <a href="{{ url_for('painel_routes.insights') }}" class="flex flex-col items-center hover:scale-110 hover:text-lime-300 transition duration-200">
        <span class="brand-badge glow-amber mb-3">
          <span class="brand-ring"></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-amber-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M9 18h6" stroke-linecap="round"/>
            <path d="M10 22h4" stroke-linecap="round"/>
            <path d="M2 11a8 8 0 1 1 16 0c0 2.5-1.2 3.8-2.2 4.7-.7.6-1.3 1.2-1.3 2.3H9.5c0-1.1-.6-1.7-1.3-2.3C3.2 14.8 2 13.5 2 11Z" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span>Buscar Insights</span>
      </a>

      <!-- Exportar nossas APIs -->
      <a href="{{ url_for('painel_routes.exportacoes') }}" class="flex flex-col items-center hover:scale-110 hover:text-lime-300 transition duration-200">
        <span class="brand-badge glow-fuchsia mb-3">
          <span class="brand-ring"></span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-fuchsia-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="18" cy="5" r="3"/>
            <circle cx="6" cy="12" r="3"/>
            <circle cx="18" cy="19" r="3"/>
            <path d="M8.6 13.1l6.8 3.8M15.4 7.1L8.6 10.9" stroke-linecap="round"/>
          </svg>
        </span>
        <span>Exportar nossas APIs</span>
      </a>
    </div>
  </section>


<!-- üî• Estrat√©gias recentes -->
  <section class="container-if section pt-4 pb-10">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-xl md:text-2xl font-semibold">Estrat√©gias recentes</h2>
      <div class="flex items-center gap-4">
        <a href="{{ url_for('painel_routes.pagina_estrategias') }}" class="text-sm opacity-80 hover:opacity-100 underline">
          ver todas
        </a>
        <a href="{{ url_for('painel_routes.upload_page') }}" class="btn btn-primary">+ Adicionar</a>
      </div>
    </div>

    <div id="recent-strategies" class="if-grid">
      <!-- cards s√£o injetados via JS -->
    </div>
    <div id="slot-estado-atual"
     hx-get="{{ url_for('painel_routes.painel_estado_atual') }}"
     hx-trigger="load, every 10s"
     hx-swap="outerHTML">
  <!-- skeleton enquanto carrega -->
  <div class="h-28 rounded-2xl bg-slate-800/40 animate-pulse"></div>
</div>


    <div id="recent-empty" class="hidden text-sm opacity-80 mt-6">
      Voc√™ ainda n√£o enviou nenhuma estrat√©gia. Fa√ßa o <a class="underline" href="{{ url_for('painel_routes.upload_page') }}">upload</a> da primeira para come√ßar.
    </div>
  </section>
</main>
{% endblock %}
{% block scripts %}
  <script defer src="{{ url_for('static', filename='js/dashboard_recent.js') }}"></script>
{% endblock %}
